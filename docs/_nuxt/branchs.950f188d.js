import{_ as se}from"./SelectCity.vue.cf15e435.js";import{d as Q,u as W,a as X,b as Y,w as re,r as o,o as k,c as F,e as a,f as t,g as B,t as v,h as e,m as j,i as H,j as Z,k as A,l as K,n as le,p as ce,q as ie,F as de,s as me,v as ue,x as O}from"./entry.e02c836d.js";import{t as _e,z,u as pe,a as E}from"./vee-validate-zod.esm.1adbbd66.js";import{_ as ve}from"./ListEmptyBanner.947973c2.js";import{u as fe}from"./location.fb6b0d77.js";const ge=Q({__name:"CreateBranch",props:{selectedBranch:{}},emits:["clear","added"],setup(J,{emit:h}){const{$api:w}=Z(),{t:d}=W(),p=J,f=h,{setLoading:C}=X(),{setError:I,setSuccess:P}=Y(),b=_e(z.object({name:z.string().min(1).max(500),address:z.string().min(1).max(500),description:z.string().min(1).max(500),locationId:z.number()})),{errors:u,values:r,handleSubmit:m,defineComponentBinds:g,handleReset:$,setValues:S}=pe({validationSchema:b}),R=g("name"),D=g("address"),M=g("locationId"),T=g("description");re(()=>p.selectedBranch,()=>{p.selectedBranch&&S(p.selectedBranch)});const c=m(async()=>{var s,l;try{if(!r.name||!r.address||!r.locationId||!r.description)return;C("global",!0);const{status:n,data:_,error:y}=p.selectedBranch?await w.branch.updateBranch(p.selectedBranch.id,{name:r.name,address:r.address,description:r.description,locationId:r.locationId}):await w.branch.createBranch({name:r.name,address:r.address,description:r.description,locationId:r.locationId});n.value==="success"&&(f("added",_.value),P({title:d("messages.successBranchCreate")}),$()),n.value==="error"&&I({title:d(`errors.${((s=y.value)==null?void 0:s.data)||""}`)})}catch(n){(l=n==null?void 0:n.response)!=null&&l._data&&I({title:n.response._data.error||""})}finally{C("global",!1)}},()=>{});function i(){$(),f("clear")}return(s,l)=>{const n=o("v-col"),_=o("v-row"),y=o("v-text-field"),V=se,N=o("v-btn"),L=o("v-textarea"),q=o("v-container"),U=o("v-form");return k(),F(U,null,{default:a(()=>[t(q,null,{default:a(()=>[t(_,{class:"text-h6 text-left",justify:"space-between"},{default:a(()=>[t(n,null,{default:a(()=>[B(v(e(d)("titles.branches")),1)]),_:1})]),_:1}),t(_,{align:"stretch"},{default:a(()=>[t(n,{cols:"12",md:"4",order:"1"},{default:a(()=>[t(y,j(e(R),{label:e(d)("labels.branchName"),"error-messages":("zodI18n"in s?s.zodI18n:e(E))(e(u).name),"hide-details":""}),null,16,["label","error-messages"])]),_:1}),t(n,{cols:"12",md:"4",order:"2"},{default:a(()=>[t(V,j(e(M),{label:e(d)("labels.city"),"error-messages":("zodI18n"in s?s.zodI18n:e(E))(e(u).locationId)}),null,16,["label","error-messages"])]),_:1}),t(n,{cols:"12",md:"4",order:"4","order-md":"3",class:"flex justify-end gap-5"},{default:a(()=>[t(N,{variant:"elevated",type:"submit",color:"secondary",size:"x-large",onClick:H(e(c),["prevent"])},{default:a(()=>[B(v(s.selectedBranch?e(d)("commands.update"):e(d)("commands.submit")),1)]),_:1},8,["onClick"]),t(N,{variant:"elevated",color:"error",size:"x-large",onClick:H(i,["prevent"])},{default:a(()=>[B(v(e(d)("commands.clear")),1)]),_:1})]),_:1}),t(n,{cols:"12",md:"6",order:"3","order-md":"4"},{default:a(()=>[t(L,j(e(D),{rows:1,label:e(d)("labels.branchAddress"),"error-messages":("zodI18n"in s?s.zodI18n:e(E))(e(u).address)}),null,16,["label","error-messages"])]),_:1}),t(n,{cols:"12",md:"6",order:"3","order-md":"4"},{default:a(()=>[t(L,j(e(T),{rows:1,label:e(d)("labels.branchDescription"),"error-messages":("zodI18n"in s?s.zodI18n:e(E))(e(u).description)}),null,16,["label","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),Ce=Q({__name:"branchs",async setup(J){let h,w;const d=fe(),{$api:p}=Z(),{t:f}=W(),{setLoading:C}=X(),{setError:I,setSuccess:P}=Y(),b=A(),u=A(1),r=A(5),m=A([]),g=K(()=>Math.ceil(m.value.length/r.value)),$=K(()=>c=>{var i;return((i=d.getCityById(c))==null?void 0:i.name)||""}),{data:S}=([h,w]=le(()=>p.branch.getBranchs()),h=await h,w(),h);S.value&&(m.value=S.value);function R(c){b.value?m.value=m.value.map(i=>i.id===c.id?c:i):m.value.unshift(c)}function D(c){b.value=c}function M(){b.value=void 0}async function T(c){var i,s;try{C("global",!0);const{status:l,error:n}=await p.branch.removeBranch(c.id);l.value==="success"&&(m.value=m.value.filter(_=>_.id!==c.id),P({title:f("messages.successBranchRemove")})),l.value==="error"&&I({title:f(`errors.${((i=n.value)==null?void 0:i.data)||""}`)})}catch(l){(s=l==null?void 0:l.response)!=null&&s._data&&I({title:l.response._data.error||""})}finally{C("global",!1)}}return(c,i)=>{const s=ge,l=o("v-divider"),n=o("v-col"),_=o("v-tooltip"),y=o("v-icon"),V=o("v-btn"),N=o("v-row"),L=o("v-list-item"),q=o("v-list"),U=ve,ee=o("v-data-iterator"),te=o("v-pagination"),ae=o("v-container");return k(),F(ae,null,{default:a(()=>[t(s,{"selected-branch":e(b),onClear:M,onAdded:R},null,8,["selected-branch"]),t(l,{inset:"",class:"my-4 !max-w-full !ms-0"}),t(ee,{items:e(m),page:e(u),"items-per-page":e(r)},{default:a(({items:G})=>[t(q,{variant:"elevated"},{default:a(()=>[(k(!0),ce(de,null,ie(G,(x,ne)=>(k(),F(L,{key:ne,variant:"elevated",class:"mb-4 cursor-pointer",onClick:oe=>D(x.raw)},{default:a(()=>[t(N,null,{default:a(()=>[t(n,{cols:"6","align-self":"center",class:"border !!border-r-2px !border-r-solid !border-r-color1"},{default:a(()=>[O("div",null,v(x.raw.name),1),O("div",null,v(x.raw.address),1)]),_:2},1024),t(n,{"align-self":"center"},{default:a(()=>[B(v(e($)(x.raw.locationId)),1)]),_:2},1024),t(n,{class:"flex justify-end gap-2"},{default:a(()=>[t(V,{variant:"plain",color:"primary",icon:!0},{default:a(()=>[t(_,{activator:"parent",branch:"top"},{default:a(()=>[B(v(e(f)("commands.select")),1)]),_:1}),t(y,{icon:"mdi mdi-button-pointer",size:"large"})]),_:1}),t(V,{variant:"plain",color:"error",icon:!0,class:"cursor-pointer",onClick:H(oe=>T(x.raw),["stop"])},{default:a(()=>[t(_,{activator:"parent",branch:"top"},{default:a(()=>[B(v(e(f)("commands.clear")),1)]),_:1}),t(y,{icon:"mdi mdi-delete",size:"large"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),"no-data":a(()=>[t(U)]),_:1},8,["items","page","items-per-page"]),t(l,{inset:"",class:"my-4 !max-w-full !ms-0"}),e(g)>1?(k(),F(te,{key:0,modelValue:e(u),"onUpdate:modelValue":i[0]||(i[0]=G=>me(u)?u.value=G:null),length:e(g),size:"x-small"},null,8,["modelValue","length"])):ue("",!0)]),_:1})}}});export{Ce as default};
