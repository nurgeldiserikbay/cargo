import{d as D,u as U,a as q,b as G,y as H,l as C,k as J,w as K,z as O,r as o,o as x,c as Q,e as l,j as W,f as n,g as y,t as p,h as e,p as X,v as Y,m as Z,s as ee,i as te}from"./entry.5eda0046.js";import{t as ae,z as w,u as se,a as oe}from"./vee-validate-zod.esm.3d58aef7.js";import{u as ce}from"./branch.8b57f4da.js";const ne={key:0},ie=D({__name:"checkProduct",setup(re){const _=ce(),{$api:B}=W(),{t:c}=U(),{setLoading:h}=q(),{setError:v,setSuccess:I}=G(),{data:b}=H(),S=C(()=>t=>_.getBranchById(t)),z=C(()=>t=>{var a;return((a=S.value(t))==null?void 0:a.address)||""}),T=ae(w.object({trackCode:w.string().min(1).max(500)})),{errors:V,values:m,handleSubmit:N,defineComponentBinds:P,handleReset:j}=se({validationSchema:T}),A=P("trackCode"),u=J(!1);let r=null;K(()=>m.trackCode,()=>{u.value&&(r&&clearTimeout(r),r=setTimeout(()=>{k()},300))}),O(async()=>{await _.fetchBranches()});const F=N(()=>{r&&clearTimeout(r),k()},()=>{});function R(t){return t.split(" ")}async function k(){var t,a;try{if(!m.trackCode)return;h("global",!0);const s=R(m.trackCode),{status:d,error:f}=await B.product.updateByTrackCodes(s);d.value==="success"&&(I({title:c("messages.successProductRegistered")}),j()),d.value==="error"&&v({title:c(`errors.${((t=f.value)==null?void 0:t.data)||""}`)})}catch(s){(a=s==null?void 0:s.response)!=null&&a._data&&v({title:s.response._data.error||""})}finally{h("global",!1)}}return(t,a)=>{const s=o("v-col"),d=o("v-row"),f=o("v-text-field"),$=o("v-checkbox"),E=o("v-btn"),L=o("v-form"),M=o("v-container");return x(),Q(M,{class:"!pt-10"},{default:l(()=>[n(d,{class:"mb-10",justify:"space-between"},{default:l(()=>[n(s,{class:"text-h4 text-center"},{default:l(()=>{var i,g;return[y(p(e(c)("titles.checkProduct"))+" ",1),(i=e(b))!=null&&i.warehouseId?(x(),X("span",ne,"("+p(e(z)((g=e(b))==null?void 0:g.warehouseId))+")",1)):Y("",!0)]}),_:1})]),_:1}),n(L,{class:"max-w-500px m-auto flex flex-col"},{default:l(()=>[n(f,Z(e(A),{label:e(c)("labels.trackCode"),"error-messages":("zodI18n"in t?t.zodI18n:e(oe))(e(V).trackCode),"hide-details":"",clearable:!0,autofocus:!0,type:"textarea"}),null,16,["label","error-messages"]),n($,{modelValue:e(u),"onUpdate:modelValue":a[0]||(a[0]=i=>ee(u)?u.value=i:null),label:e(c)("labels.autoFetch"),color:"indigo",value:"indigo","hide-details":"",class:"mb-5 self-end"},null,8,["modelValue","label"]),n(E,{variant:"elevated",type:"submit",color:"secondary",size:"x-large",class:"m-auto",onClick:te(e(F),["prevent"])},{default:l(()=>[y(p(e(c)("commands.submit")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})}}});export{ie as default};
