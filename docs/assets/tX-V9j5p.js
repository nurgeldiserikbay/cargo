import{v as me,_ as ue}from"./CHrKzI2O.js";import{_ as fe}from"./BoD4mPh3.js";import{_ as pe}from"./CQyW7zkg.js";import{d as _e,a as T,w as be,c as ve,an as he,N as g,o as d,j as _,ac as a,Q as s,aa as w,ab as l,u as e,ah as x,k as B,a7 as N,X as y,m as I,A as ge,P as we,ae as K}from"./9z15omkZ.js";import{u as Ne,a as ye,b as ke,d as Ie,r as ze,e as Ce,c as Pe,L as Se,k as xe}from"./BT9LgsZd.js";import{t as Be,z as b,u as Te,a as k}from"./Bidafszn.js";import{u as $e}from"./BO6X2MPq.js";import"./B4L4hn--.js";const Ae={class:"text-h4"},Ve={class:"mr-2"},je={key:1},Oe={key:1},Le={key:1},Ee={key:1},Fe={key:0,class:"flex justify-between gap-8"},De={class:"text-sm"},Me={class:"mr-2"},Ue={class:"mr-2"},Ye={class:"mr-2"},Ke=_e({__name:"profile",async setup(Ze){let $,A;const{$api:Z}=Pe(),{t:r}=Ne(),{setLoading:V}=ye(),{setError:j,setSuccess:q}=ke(),O=$e(),{data:m,getSession:Q}=Ie(),i=T(!1),z=T(!1),R=Be(b.object({firstName:b.string().min(1).max(200),lastName:b.string().min(1).max(200),email:b.string().email(),password:b.string().min(4).optional(),confirmPassword:b.string().min(4).optional(),phoneNumber:b.string().refine(t=>me.isMobilePhone(t.replace(/\D/g,""),"kk-KZ")),warehouseId:b.number()}));be([i,z],()=>{var t,c,o,f,u;G({firstName:((t=m.value)==null?void 0:t.firstName)||"",lastName:((c=m.value)==null?void 0:c.lastName)||"",email:((o=m.value)==null?void 0:o.email)||"",phoneNumber:((f=m.value)==null?void 0:f.phoneNumber)||"",warehouseId:Number((u=m.value)==null?void 0:u.warehouseId)}),P.password="",P.confirmPassword=""});const{errors:v,values:P,handleSubmit:X,defineComponentBinds:h,setValues:G}=Te({validationSchema:R}),H=h("firstName"),J=h("lastName"),W=h("email"),ee=h("phoneNumber"),L=h("password"),se=h("confirmPassword"),ae=h("warehouseId"),S=T();function E(){oe()}const oe=X(async()=>{var t,c;try{V("global",!0);const o=ze({...P,phoneNumber:Ce(P.phoneNumber||"")},["confirmPassword"]),{status:f,error:u}=await Z.user.updateUser(o);f.value==="success"&&(i.value=!1,await Q(),q({title:r("messages.successUpdateData")})),f.value==="error"&&j({title:r(`errors.${((t=u.value)==null?void 0:t.data)||""}`)})}catch(o){(c=o==null?void 0:o.response)!=null&&c._data&&j({title:o.response._data.error||""})}finally{V("global",!1)}},()=>{}),F=ve(()=>t=>O.getBranchById(t));[$,A]=he(()=>O.fetchBranches()),await $,A();function te(){z.value=!z.value}return(t,c)=>{const o=g("v-col"),f=g("v-icon"),u=g("v-btn"),p=g("v-row"),C=g("v-text-field"),le=ue,re=fe,ne=pe,ie=g("v-card"),de=g("v-container");return d(),_(de,{class:"settings flex-grow-1 d-flex flex-col justify-start items-center pt-10"},{default:a(()=>[s(ie,{class:"w-full min-h-[50vh] border-box px-5 py-6 relative !overflow-visible"},{default:a(()=>{var D;return[s(p,{class:"mb-4"},{default:a(()=>[s(o,{class:"!p-1"},{default:a(()=>[w("div",Ae,l(e(i)?e(r)("pages.settingsChange"):e(r)("pages.settings")),1)]),_:1}),e(i)?x("",!0):(d(),_(o,{key:0,cols:"12",md:"3",class:"flex justify-end items-center"},{default:a(()=>[s(u,{color:"yellow",onClick:c[0]||(c[0]=n=>i.value=!0)},{default:a(()=>[w("span",Ve,l(e(r)("commands.change")),1),s(f,{icon:"mdi mdi-pencil-box-multiple-outline",size:"x-large"})]),_:1})]),_:1}))]),_:1}),s(p,{class:B({"border-b border-color-color2":!e(i)})},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(r)("labels.firstName"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var n;return[e(i)?(d(),_(C,y({key:0},e(H),{variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(k))(e(v).firstName)}),{"append-inner":a(()=>[s(f,{icon:"mdi mdi-asterisk",size:"x-small",color:"red"})]),_:1},16,["error-messages"])):(d(),I("div",je,l((n=e(m))==null?void 0:n.firstName),1))]}),_:1})]),_:1},8,["class"]),s(p,{class:B({"border-b border-color-color2":!e(i)})},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(r)("labels.lastName"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var n;return[e(i)?(d(),_(C,y({key:0},e(J),{variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(k))(e(v).lastName)}),{"append-inner":a(()=>[s(f,{icon:"mdi mdi-asterisk",size:"x-small",color:"red"})]),_:1},16,["error-messages"])):(d(),I("div",Oe,l((n=e(m))==null?void 0:n.lastName),1))]}),_:1})]),_:1},8,["class"]),s(p,{class:B({"border-b border-color-color2":!e(i)})},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(r)("labels.email"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var n;return[e(i)?(d(),_(C,y({key:0},e(W),{variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(k))(e(v).email)}),null,16,["error-messages"])):(d(),I("div",Le,l((n=e(m))==null?void 0:n.email),1))]}),_:1})]),_:1},8,["class"]),s(p,{class:B({"border-b border-color-color2":!e(i)})},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(r)("labels.phoneNumber"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var n;return[e(i)?(d(),_(le,y({key:0},e(ee),{required:!0,"with-labels":!1,"error-messages":("zodI18n"in t?t.zodI18n:e(k))(e(v).phoneNumber)}),null,16,["error-messages"])):(d(),I("div",Ee,l((n=e(m))==null?void 0:n.phoneNumber),1))]}),_:1})]),_:1},8,["class"]),Number.isFinite((D=e(m))==null?void 0:D.warehouseId)?(d(),_(p,{key:0},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(r)("labels.branch"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var n,M,U,Y;return[e(i)?(d(),I("div",Fe,[s(re,y(e(ae),{"city-id":e(S),errors:("zodI18n"in t?t.zodI18n:e(k))(e(v).warehouseId),"with-labels":!1,class:"max-w-1/2"}),null,16,["city-id","errors"]),s(ne,{modelValue:e(S),"onUpdate:modelValue":c[1]||(c[1]=ce=>ge(S)?S.value=ce:null),class:"max-w-1/2","with-labels":!1,"location-filter":("LOCATION_TYPES"in t?t.LOCATION_TYPES:e(Se)).KZ},null,8,["modelValue","location-filter"])])):(d(),I(we,{key:1},[w("div",null,l((M=e(F)((n=e(m))==null?void 0:n.warehouseId))==null?void 0:M.name),1),w("div",De,l((Y=e(F)((U=e(m))==null?void 0:U.warehouseId))==null?void 0:Y.address),1)],64))]}),_:1})]),_:1})):x("",!0),e(i)?(d(),_(p,{key:1},{default:a(()=>[s(o,{class:"flex justify-center gap-5"},{default:a(()=>[s(u,{color:"red",onClick:c[2]||(c[2]=n=>i.value=!1)},{default:a(()=>[w("span",Me,l(e(r)("commands.cancel")),1),s(f,{icon:"mdi mdi-cancel",size:"x-large"})]),_:1}),s(u,{class:"me-4",variant:"elevated",type:"submit",color:"green-accent-2",disabled:!1,onClick:K(E,["prevent"])},{default:a(()=>[N(l(e(r)("commands.save")),1)]),_:1})]),_:1})]),_:1})):x("",!0),s(p,{class:"mt-5 mb-3"},{default:a(()=>[s(o,{cols:"12",md:"4"},{default:a(()=>[s(u,{onClick:K(te,["stop"])},{default:a(()=>[w("span",Ue,l(e(r)("labels.changePassword")),1)]),_:1})]),_:1})]),_:1}),e(z)?(d(),_(p,{key:2,class:"items-center"},{default:a(()=>[s(o,{cols:"12",md:"3"},{default:a(()=>[s(C,y(e(L),{type:"password",label:e(r)("labels.password"),variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(k))(e(v).password)}),null,16,["label","error-messages"])]),_:1}),s(o,{cols:"12",md:"3"},{default:a(()=>[s(C,y(e(se),{type:"password",label:e(r)("labels.confirmPassword"),variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(k))(e(v).confirmPassword)}),null,16,["label","error-messages"])]),_:1}),s(o,{cols:"12",md:"3",class:"flex gap-3"},{default:a(()=>[s(u,{color:"primary",class:"mb-3",disabled:!e(L),onClick:E},{default:a(()=>[w("span",Ye,l(e(r)("commands.update")),1)]),_:1},8,["disabled"]),s(u,{class:"mb-3",variant:"elevated",onClick:c[3]||(c[3]=n=>z.value=!1)},{default:a(()=>[N(l(e(r)("commands.cancel")),1)]),_:1})]),_:1})]),_:1})):x("",!0)]}),_:1})]),_:1})}}}),es=xe(Ke,[["__scopeId","data-v-7242271d"]]);export{es as default};
