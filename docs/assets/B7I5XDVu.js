import{_ as le}from"./NrRhoOlY.js";import{d as W,u as X,a as Y,b as Z,w as ce,r as s,o as w,c as E,e as a,f as t,g as B,t as v,h as e,m as j,i as H,j as ee,k as A,l as K,n as ie,p as de,q as me,s as O,F as ue,v as _e,x as pe,y as ve,z as Q}from"./BL35Lc_y.js";import{t as fe,z as k,u as he,a as D}from"./FrhPwdqL.js";import{_ as ge}from"./fVVyMGEp.js";import{u as be}from"./BebbxeDx.js";const ye=W({__name:"CreateBranch",props:{selectedBranch:{}},emits:["clear","added"],setup(J,{emit:g}){const{$api:C}=ee(),{t:d}=X(),p=J,f=g,{setLoading:I}=Y(),{setError:x,setSuccess:F}=Z(),b=fe(k.object({name:k.string().min(1).max(500),address:k.string().min(1).max(500),description:k.string().min(1).max(500),locationId:k.number()})),{errors:u,values:r,handleSubmit:m,defineComponentBinds:h,handleReset:$,setValues:S}=he({validationSchema:b}),P=h("name"),R=h("address"),M=h("locationId"),T=h("description");ce(()=>p.selectedBranch,()=>{p.selectedBranch&&S(p.selectedBranch)});const c=m(async()=>{var o,l;try{if(!r.name||!r.address||!r.locationId||!r.description)return;I("global",!0);const{status:n,data:_,error:y}=p.selectedBranch?await C.branch.updateBranch(p.selectedBranch.id,{name:r.name,address:r.address,description:r.description,locationId:r.locationId}):await C.branch.createBranch({name:r.name,address:r.address,description:r.description,locationId:r.locationId});n.value==="success"&&(f("added",_.value),F({title:d("messages.successBranchCreate")}),$()),n.value==="error"&&x({title:d(`errors.${((o=y.value)==null?void 0:o.data)||""}`)})}catch(n){(l=n==null?void 0:n.response)!=null&&l._data&&x({title:n.response._data.error||""})}finally{I("global",!1)}},()=>{});function i(){$(),f("clear")}return(o,l)=>{const n=s("v-col"),_=s("v-row"),y=s("v-text-field"),V=le,N=s("v-btn"),L=s("v-textarea"),q=s("v-container"),U=s("v-form");return w(),E(U,null,{default:a(()=>[t(q,null,{default:a(()=>[t(_,{class:"text-h6 text-left",justify:"space-between"},{default:a(()=>[t(n,null,{default:a(()=>[B(v(e(d)("titles.branches")),1)]),_:1})]),_:1}),t(_,{align:"stretch"},{default:a(()=>[t(n,{cols:"12",md:"4",order:"1"},{default:a(()=>[t(y,j(e(P),{label:e(d)("labels.branchName"),"error-messages":("zodI18n"in o?o.zodI18n:e(D))(e(u).name),"hide-details":""}),null,16,["label","error-messages"])]),_:1}),t(n,{cols:"12",md:"4",order:"2"},{default:a(()=>[t(V,j(e(M),{label:e(d)("labels.city"),"error-messages":("zodI18n"in o?o.zodI18n:e(D))(e(u).locationId)}),null,16,["label","error-messages"])]),_:1}),t(n,{cols:"12",md:"4",order:"4","order-md":"3",class:"flex justify-end gap-5"},{default:a(()=>[t(N,{variant:"elevated",type:"submit",color:"secondary",size:"x-large",onClick:H(e(c),["prevent"])},{default:a(()=>[B(v(o.selectedBranch?e(d)("commands.update"):e(d)("commands.submit")),1)]),_:1},8,["onClick"]),t(N,{variant:"elevated",color:"error",size:"x-large",onClick:H(i,["prevent"])},{default:a(()=>[B(v(e(d)("commands.clear")),1)]),_:1})]),_:1}),t(n,{cols:"12",md:"6",order:"3","order-md":"4"},{default:a(()=>[t(L,j(e(R),{rows:1,label:e(d)("labels.branchAddress"),"error-messages":("zodI18n"in o?o.zodI18n:e(D))(e(u).address)}),null,16,["label","error-messages"])]),_:1}),t(n,{cols:"12",md:"6",order:"3","order-md":"4"},{default:a(()=>[t(L,j(e(T),{rows:1,label:e(d)("labels.branchDescription"),"error-messages":("zodI18n"in o?o.zodI18n:e(D))(e(u).description)}),null,16,["label","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),we={class:"overflow-y-hidden w-full hidden-scroll select-none"},ke=W({__name:"branchs",async setup(J){let g,C;const d=be(),{$api:p}=ee(),{t:f}=X(),{setLoading:I}=Y(),{setError:x,setSuccess:F}=Z(),b=A(),u=A(1),r=A(5),m=A([]),h=K(()=>Math.ceil(m.value.length/r.value)),$=K(()=>c=>{var i;return((i=d.getCityById(c))==null?void 0:i.name)||""}),{data:S}=([g,C]=ie(()=>p.branch.getBranchs()),g=await g,C(),g);S.value&&(m.value=S.value);function P(c){b.value?m.value=m.value.map(i=>i.id===c.id?c:i):m.value.unshift(c)}function R(c){b.value=c}function M(){b.value=void 0}async function T(c){var i,o;try{I("global",!0);const{status:l,error:n}=await p.branch.removeBranch(c.id);l.value==="success"&&(m.value=m.value.filter(_=>_.id!==c.id),F({title:f("messages.successBranchRemove")})),l.value==="error"&&x({title:f(`errors.${((i=n.value)==null?void 0:i.data)||""}`)})}catch(l){(o=l==null?void 0:l.response)!=null&&o._data&&x({title:l.response._data.error||""})}finally{I("global",!1)}}return(c,i)=>{const o=ye,l=s("v-divider"),n=s("v-col"),_=s("v-tooltip"),y=s("v-icon"),V=s("v-btn"),N=s("v-row"),L=s("v-list-item"),q=s("v-list"),U=ge,te=s("v-data-iterator"),ae=s("v-pagination"),ne=s("v-container"),se=de("dragscroll");return w(),E(ne,null,{default:a(()=>[t(o,{"selected-branch":e(b),onClear:M,onAdded:P},null,8,["selected-branch"]),t(l,{inset:"",class:"my-4 !max-w-full !ms-0"}),me((w(),O("div",we,[t(te,{items:e(m),page:e(u),"items-per-page":e(r),class:"min-w-[600px]"},{default:a(({items:G})=>[t(q,{variant:"elevated"},{default:a(()=>[(w(!0),O(ue,null,_e(G,(z,oe)=>(w(),E(L,{key:oe,variant:"elevated",class:"mb-4 cursor-pointer",onClick:re=>R(z.raw)},{default:a(()=>[t(N,null,{default:a(()=>[t(n,{cols:"6","align-self":"center",class:"border !!border-r-2px !border-r-solid !border-r-color1"},{default:a(()=>[Q("div",null,v(z.raw.name),1),Q("div",null,v(z.raw.address),1)]),_:2},1024),t(n,{"align-self":"center"},{default:a(()=>[B(v(e($)(z.raw.locationId)),1)]),_:2},1024),t(n,{class:"flex justify-end gap-2"},{default:a(()=>[t(V,{variant:"plain",color:"primary",icon:!0},{default:a(()=>[t(_,{activator:"parent",branch:"top"},{default:a(()=>[B(v(e(f)("commands.select")),1)]),_:1}),t(y,{icon:"mdi mdi-button-pointer",size:"large"})]),_:1}),t(V,{variant:"plain",color:"error",icon:!0,class:"cursor-pointer",onClick:H(re=>T(z.raw),["stop"])},{default:a(()=>[t(_,{activator:"parent",branch:"top"},{default:a(()=>[B(v(e(f)("commands.clear")),1)]),_:1}),t(y,{icon:"mdi mdi-delete",size:"large"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),"no-data":a(()=>[t(U)]),_:1},8,["items","page","items-per-page"])])),[[se]]),t(l,{inset:"",class:"my-4 !max-w-full !ms-0"}),e(h)>1?(w(),E(ae,{key:0,modelValue:e(u),"onUpdate:modelValue":i[0]||(i[0]=G=>pe(u)?u.value=G:null),length:e(h),size:"x-small"},null,8,["modelValue","length"])):ve("",!0)]),_:1})}}});export{ke as default};
