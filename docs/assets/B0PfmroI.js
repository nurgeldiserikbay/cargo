import{v as me,_ as ue}from"./DEsE7NMS.js";import{_ as fe}from"./DA7wHOdZ.js";import{_ as pe}from"./NrRhoOlY.js";import{d as _e,u as be,a as ve,b as he,A as ge,k as T,w as we,M as Ne,C as ye,l as Ie,n as ke,r as g,o as d,c as _,e as a,j as ze,f as s,z as w,t as l,h as e,y as P,J as B,g as N,m as y,s as k,x as Ce,L as Se,F as xe,i as K,N as Pe}from"./BL35Lc_y.js";import{t as Be,z as b,u as Te,a as I}from"./FrhPwdqL.js";import{u as $e}from"./CJIBvVXL.js";import"./BebbxeDx.js";const Ae={class:"text-h4"},Ve={class:"mr-2"},je={key:1},Oe={key:1},Fe={key:1},Le={key:1},Ee={key:0,class:"flex justify-between gap-8"},De={class:"text-sm"},Me={class:"mr-2"},Ue={class:"mr-2"},Ye={class:"mr-2"},Ke=_e({__name:"settings",async setup(Ze){let $,A;const{$api:Z}=ze(),{t:n}=be(),{setLoading:V}=ve(),{setError:j,setSuccess:q}=he(),O=$e(),{data:m,getSession:J}=ge(),i=T(!1),z=T(!1),R=Be(b.object({firstName:b.string().min(1).max(200),lastName:b.string().min(1).max(200),email:b.string().email(),password:b.string().min(4).optional(),confirmPassword:b.string().min(4).optional(),phoneNumber:b.string().refine(t=>me.isMobilePhone(t.replace(/\D/g,""),"kk-KZ")),warehouseId:b.number()}));we([i,z],()=>{var t,c,o,f,u;H({firstName:((t=m.value)==null?void 0:t.firstName)||"",lastName:((c=m.value)==null?void 0:c.lastName)||"",email:((o=m.value)==null?void 0:o.email)||"",phoneNumber:((f=m.value)==null?void 0:f.phoneNumber)||"",warehouseId:Number((u=m.value)==null?void 0:u.warehouseId)}),S.password="",S.confirmPassword=""});const{errors:v,values:S,handleSubmit:G,defineComponentBinds:h,setValues:H}=Te({validationSchema:R}),Q=h("firstName"),W=h("lastName"),X=h("email"),ee=h("phoneNumber"),F=h("password"),se=h("confirmPassword"),ae=h("warehouseId"),x=T();function L(){oe()}const oe=G(async()=>{var t,c;try{V("global",!0);const o=Ne({...S,phoneNumber:ye(S.phoneNumber||"")},["confirmPassword"]),{status:f,error:u}=await Z.user.updateUser(o);f.value==="success"&&(i.value=!1,await J(),q({title:n("messages.successUpdateData")})),f.value==="error"&&j({title:n(`errors.${((t=u.value)==null?void 0:t.data)||""}`)})}catch(o){(c=o==null?void 0:o.response)!=null&&c._data&&j({title:o.response._data.error||""})}finally{V("global",!1)}},()=>{}),E=Ie(()=>t=>O.getBranchById(t));[$,A]=ke(()=>O.fetchBranches()),await $,A();function te(){z.value=!z.value}return(t,c)=>{const o=g("v-col"),f=g("v-icon"),u=g("v-btn"),p=g("v-row"),C=g("v-text-field"),le=ue,ne=fe,re=pe,ie=g("v-card"),de=g("v-container");return d(),_(de,{class:"settings flex-grow-1 d-flex flex-col justify-start items-center pt-10"},{default:a(()=>[s(ie,{class:"w-full min-h-[50vh] border-box px-5 py-6 relative !overflow-visible"},{default:a(()=>{var D;return[s(p,{class:"mb-4"},{default:a(()=>[s(o,{class:"!p-1"},{default:a(()=>[w("div",Ae,l(e(i)?e(n)("pages.settingsChange"):e(n)("pages.settings")),1)]),_:1}),e(i)?P("",!0):(d(),_(o,{key:0,cols:"12",md:"3",class:"flex justify-end items-center"},{default:a(()=>[s(u,{color:"yellow",onClick:c[0]||(c[0]=r=>i.value=!0)},{default:a(()=>[w("span",Ve,l(e(n)("commands.change")),1),s(f,{icon:"mdi mdi-pencil-box-multiple-outline",size:"x-large"})]),_:1})]),_:1}))]),_:1}),s(p,{class:B({"border-b border-color-color2":!e(i)})},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(n)("labels.firstName"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var r;return[e(i)?(d(),_(C,y({key:0},e(Q),{variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(I))(e(v).firstName)}),{"append-inner":a(()=>[s(f,{icon:"mdi mdi-asterisk",size:"x-small",color:"red"})]),_:1},16,["error-messages"])):(d(),k("div",je,l((r=e(m))==null?void 0:r.firstName),1))]}),_:1})]),_:1},8,["class"]),s(p,{class:B({"border-b border-color-color2":!e(i)})},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(n)("labels.lastName"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var r;return[e(i)?(d(),_(C,y({key:0},e(W),{variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(I))(e(v).lastName)}),{"append-inner":a(()=>[s(f,{icon:"mdi mdi-asterisk",size:"x-small",color:"red"})]),_:1},16,["error-messages"])):(d(),k("div",Oe,l((r=e(m))==null?void 0:r.lastName),1))]}),_:1})]),_:1},8,["class"]),s(p,{class:B({"border-b border-color-color2":!e(i)})},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(n)("labels.email"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var r;return[e(i)?(d(),_(C,y({key:0},e(X),{variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(I))(e(v).email)}),null,16,["error-messages"])):(d(),k("div",Fe,l((r=e(m))==null?void 0:r.email),1))]}),_:1})]),_:1},8,["class"]),s(p,{class:B({"border-b border-color-color2":!e(i)})},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(n)("labels.phoneNumber"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var r;return[e(i)?(d(),_(le,y({key:0},e(ee),{required:!0,"with-labels":!1,"error-messages":("zodI18n"in t?t.zodI18n:e(I))(e(v).phoneNumber)}),null,16,["error-messages"])):(d(),k("div",Le,l((r=e(m))==null?void 0:r.phoneNumber),1))]}),_:1})]),_:1},8,["class"]),Number.isFinite((D=e(m))==null?void 0:D.warehouseId)?(d(),_(p,{key:0},{default:a(()=>[s(o,{cols:"12",md:"3",class:"!p-1 font-600"},{default:a(()=>[N(l(e(n)("labels.branch"))+": ",1)]),_:1}),s(o,{class:"!p-1"},{default:a(()=>{var r,M,U,Y;return[e(i)?(d(),k("div",Ee,[s(ne,y(e(ae),{"city-id":e(x),errors:("zodI18n"in t?t.zodI18n:e(I))(e(v).warehouseId),"with-labels":!1,class:"max-w-1/2"}),null,16,["city-id","errors"]),s(re,{modelValue:e(x),"onUpdate:modelValue":c[1]||(c[1]=ce=>Ce(x)?x.value=ce:null),class:"max-w-1/2","with-labels":!1,"location-filter":("LOCATION_TYPES"in t?t.LOCATION_TYPES:e(Se)).KZ},null,8,["modelValue","location-filter"])])):(d(),k(xe,{key:1},[w("div",null,l((M=e(E)((r=e(m))==null?void 0:r.warehouseId))==null?void 0:M.name),1),w("div",De,l((Y=e(E)((U=e(m))==null?void 0:U.warehouseId))==null?void 0:Y.address),1)],64))]}),_:1})]),_:1})):P("",!0),e(i)?(d(),_(p,{key:1},{default:a(()=>[s(o,{class:"flex justify-center gap-5"},{default:a(()=>[s(u,{color:"red",onClick:c[2]||(c[2]=r=>i.value=!1)},{default:a(()=>[w("span",Me,l(e(n)("commands.cancel")),1),s(f,{icon:"mdi mdi-cancel",size:"x-large"})]),_:1}),s(u,{class:"me-4",variant:"elevated",type:"submit",color:"green-accent-2",disabled:!1,onClick:K(L,["prevent"])},{default:a(()=>[N(l(e(n)("commands.save")),1)]),_:1})]),_:1})]),_:1})):P("",!0),s(p,{class:"mt-5 mb-3"},{default:a(()=>[s(o,{cols:"12",md:"4"},{default:a(()=>[s(u,{onClick:K(te,["stop"])},{default:a(()=>[w("span",Ue,l(e(n)("labels.changePassword")),1)]),_:1})]),_:1})]),_:1}),e(z)?(d(),_(p,{key:2,class:"items-center"},{default:a(()=>[s(o,{cols:"12",md:"3"},{default:a(()=>[s(C,y(e(F),{type:"password",label:e(n)("labels.password"),variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(I))(e(v).password)}),null,16,["label","error-messages"])]),_:1}),s(o,{cols:"12",md:"3"},{default:a(()=>[s(C,y(e(se),{type:"password",label:e(n)("labels.confirmPassword"),variant:"underlined","error-messages":("zodI18n"in t?t.zodI18n:e(I))(e(v).confirmPassword)}),null,16,["label","error-messages"])]),_:1}),s(o,{cols:"12",md:"3",class:"flex gap-3"},{default:a(()=>[s(u,{color:"primary",class:"mb-3",disabled:!e(F),onClick:L},{default:a(()=>[w("span",Ye,l(e(n)("commands.update")),1)]),_:1},8,["disabled"]),s(u,{class:"mb-3",variant:"elevated",onClick:c[3]||(c[3]=r=>z.value=!1)},{default:a(()=>[N(l(e(n)("commands.cancel")),1)]),_:1})]),_:1})]),_:1})):P("",!0)]}),_:1})]),_:1})}}}),Xe=Pe(Ke,[["__scopeId","data-v-27008d4b"]]);export{Xe as default};
