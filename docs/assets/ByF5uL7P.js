import{u as Y,a as Z,b as q,L as B,c as G}from"./BT9LgsZd.js";import{d as J,c as W,w as se,N as s,o as C,j,ac as a,Q as e,a7 as _,ab as p,u as t,X as U,ae as K,a as E,an as le,a2 as ce,a1 as re,m as X,P as ie,ai as de,A as me,ah as ue}from"./9z15omkZ.js";import{t as _e,z as T,u as pe,a as H}from"./Bidafszn.js";import{_ as ve}from"./8XHwsNhV.js";const fe=J({__name:"CreateLocation",props:{selectedLocation:{}},emits:["clear","added"],setup(Q,{emit:f}){const{$api:x}=G(),{t:c}=Y(),i=Q,z=f,{setLoading:k}=Z(),{setError:I,setSuccess:g}=q(),y=_e(T.object({name:T.string().min(1).max(500),code:T.string().min(1).max(500),type:T.enum([B.BORDER,B.CHINA,B.KZ])})),{errors:b,values:n,handleSubmit:N,defineComponentBinds:h,handleReset:A,setValues:P}=pe({validationSchema:y}),S=h("name"),R=h("type"),d=h("code"),m=W(()=>Object.values(B).filter(o=>o!=="NULL").map(o=>({id:o,label:c("places."+o)})));se(()=>i.selectedLocation,()=>{i.selectedLocation&&P(i.selectedLocation)});const w=N(async()=>{var o,u;try{if(!n.name||!n.type||!n.code)return;k("global",!0);const{status:l,data:v,error:L}=i.selectedLocation?await x.location.updateLocation(i.selectedLocation.id,{name:n.name,code:n.code,type:n.type}):await x.location.createLocation({name:n.name,code:n.code,type:n.type});l.value==="success"&&(z("added",v.value),g({title:c("messages.successLocationCreate")}),A()),l.value==="error"&&I({title:c(`errors.${((o=L.value)==null?void 0:o.data)||""}`)})}catch(l){(u=l==null?void 0:l.response)!=null&&u._data&&I({title:l.response._data.error||""})}finally{k("global",!1)}},()=>{});function r(){A(),z("clear")}return(o,u)=>{const l=s("v-col"),v=s("v-row"),L=s("v-text-field"),D=s("v-select"),V=s("v-btn"),O=s("v-container"),F=s("v-form");return C(),j(F,null,{default:a(()=>[e(O,null,{default:a(()=>[e(v,{class:"text-h6 text-left",justify:"space-between"},{default:a(()=>[e(l,null,{default:a(()=>[_(p(t(c)("titles.locations")),1)]),_:1})]),_:1}),e(v,{align:"stretch"},{default:a(()=>[e(l,{cols:"12",md:"4"},{default:a(()=>[e(L,U(t(S),{label:t(c)("labels.cityName"),"error-messages":("zodI18n"in o?o.zodI18n:t(H))(t(b).name),"hide-details":""}),null,16,["label","error-messages"])]),_:1}),e(l,{cols:"12",md:"4"},{default:a(()=>[e(D,U(t(R),{label:t(c)("labels.cityType"),items:t(m),"item-value":"id","item-title":"label","error-messages":("zodI18n"in o?o.zodI18n:t(H))(t(b).type)}),null,16,["label","items","error-messages"])]),_:1}),e(l,{cols:"12",md:"4"},{default:a(()=>[e(L,U(t(d),{label:t(c)("labels.code"),"error-messages":("zodI18n"in o?o.zodI18n:t(H))(t(b).code),"hide-details":""}),null,16,["label","error-messages"])]),_:1}),e(l,{cols:"12",md:"4",class:"flex center gap-5"},{default:a(()=>[e(V,{variant:"elevated",type:"submit",color:"secondary",size:"x-large",onClick:K(t(w),["prevent"])},{default:a(()=>[_(p(o.selectedLocation?t(c)("commands.update"):t(c)("commands.submit")),1)]),_:1},8,["onClick"]),e(V,{variant:"elevated",color:"error",size:"x-large",onClick:K(r,["prevent"])},{default:a(()=>[_(p(t(c)("commands.clear")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),ge={class:"overflow-y-hidden w-full hidden-scroll select-none"},Le=J({__name:"locations",async setup(Q){let f,x;const{$api:c}=G(),{t:i}=Y(),{setLoading:z}=Z(),{setError:k,setSuccess:I}=q(),g=E(),y=E(1),b=E(5),n=E([]),N=W(()=>Math.ceil(n.value.length/b.value)),{data:h}=([f,x]=le(()=>c.location.getLocations()),f=await f,x(),f);h.value&&(n.value=h.value);function A(d){g.value?n.value=n.value.map(m=>m.id===d.id?d:m):n.value.unshift(d),S()}function P(d){g.value=d}function S(){g.value=void 0}async function R(d){var m,w;try{z("global",!0);const{status:r,error:o}=await c.location.removeLocation(d.id);r.value==="success"&&(n.value=n.value.filter(u=>u.id!==d.id),I({title:i("messages.successLocationRemove")})),r.value==="error"&&k({title:i(`errors.${((m=o.value)==null?void 0:m.data)||""}`)})}catch(r){(w=r==null?void 0:r.response)!=null&&w._data&&k({title:r.response._data.error||""})}finally{z("global",!1)}}return(d,m)=>{const w=fe,r=s("v-divider"),o=s("v-col"),u=s("v-tooltip"),l=s("v-icon"),v=s("v-btn"),L=s("v-row"),D=s("v-list-item"),V=s("v-list"),O=ve,F=s("v-data-iterator"),ee=s("v-pagination"),te=s("v-container"),ae=ce("dragscroll");return C(),j(te,null,{default:a(()=>[e(w,{"selected-location":t(g),onClear:S,onAdded:A},null,8,["selected-location"]),e(r,{inset:"",class:"my-4 !max-w-full !ms-0"}),re((C(),X("div",ge,[e(F,{items:t(n),page:t(y),"items-per-page":t(b),class:"min-w-[600px]"},{default:a(({items:M})=>[e(V,{variant:"elevated"},{default:a(()=>[(C(!0),X(ie,null,de(M,($,oe)=>(C(),j(D,{key:oe,variant:"elevated",class:"mb-4 cursor-pointer",onClick:ne=>P($.raw)},{default:a(()=>[e(L,null,{default:a(()=>[e(o,{"align-self":"center",class:"border !border-r-2px !border-r-solid !border-r-color1"},{default:a(()=>[_(p($.raw.name),1)]),_:2},1024),e(o,{"align-self":"center"},{default:a(()=>[_(p(t(i)(`places.${$.raw.type}`)),1)]),_:2},1024),e(o,{"align-self":"center"},{default:a(()=>[_(p($.raw.code),1)]),_:2},1024),e(o,{class:"flex justify-end gap-2"},{default:a(()=>[e(v,{variant:"plain",color:"primary",icon:!0},{default:a(()=>[e(u,{activator:"parent",location:"top"},{default:a(()=>[_(p(t(i)("commands.select")),1)]),_:1}),e(l,{icon:"mdi mdi-button-pointer",size:"large"})]),_:1}),e(v,{variant:"plain",color:"error",icon:!0,class:"cursor-pointer",onClick:K(ne=>R($.raw),["stop"])},{default:a(()=>[e(u,{activator:"parent",location:"top"},{default:a(()=>[_(p(t(i)("commands.clear")),1)]),_:1}),e(l,{icon:"mdi mdi-delete",size:"large"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),"no-data":a(()=>[e(O)]),_:1},8,["items","page","items-per-page"])])),[[ae]]),e(r,{inset:"",class:"my-4 !max-w-full !ms-0"}),t(N)>1?(C(),j(ee,{key:0,modelValue:t(y),"onUpdate:modelValue":m[0]||(m[0]=M=>me(y)?y.value=M:null),length:t(N),size:"x-small"},null,8,["modelValue","length"])):ue("",!0)]),_:1})}}});export{Le as default};
